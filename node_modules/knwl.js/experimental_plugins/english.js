/*

	This parser plugin is merely an experiment. Furthermore, 
	unlike other experimental plugins, this parser is 
	exceptionally rigid and hacked together. 
	
*/

knwl.english = {};
knwl.english.verbs = ["quell","trap","stick", "tie", "shroud", "abate","pervade","ease","deny","strive","skip","work","compound","escape","weaken","shorten","eschew","miss","envision","lengthen","relieve","tuck","reelect","download","fuse","survive","exhibit","oversee","await","close","trade","ingest","acquaint","manufacture","prefer","immerse","pretend","halt","harm","level","crave","press","relocate","streamline","broaden","faze","appeal","bottom","bring","dispel","overrule","cash","chance","digitize","fatigue","impart","venture","propose","blind","shed","exert","fish","well","foster","wade","enquire","don","disappoint","promote","do","dare","lurk","derive","arrange","provoke","reinvent","rove","exploit","fulfil","persuade","access","diagnose","have","assist","shop","saw","volunteer","outline","bombard","expect","generate","abound","modernize","include","honor","blow","ordain","fructify","counter","believe","number","understand","mould","weather","harden","proscribe","imbibe","rationalize","sell","spoil","grant","decline","preform","graze","bog","remold","permeate","adore","dissuade","cool","bless","mitigate","invent","dump","detail","scar","devise","balance","remunerate","target","evidence","debut","commute","revere","delineate","layer","crow","bother","muster","jut","attenuate","compromise","remedy","pry","dismiss","snatch","cross","rest","organise","go","exhaust","excel","languish","color","stir","relate","rob","rear","post","match","bypass","assemble","free","portray","ruin","tick","celebrate","break","economize","wonder","get","loop","regard","unleash","rap","lift","reprimand","prolong","plague","fit","shift","console","supplement","copy","breathe","fade","hone","generalize","accelerate","air","transport","dedicate","stream","symbolize","parallel","sink","mediate","experience","harvest","elude","invest","personalize","suspend","pave","take","interview","overemphasize","increase","elect","try","lionize","categorize","opine","dampen","personify","disillusion","flow","shrink","disrupt","kiss","leaf","refute","proceed","hike","implement","reconcile","accommodate","offer","evaluate","school","overreach","benefit","crawl","guard","connote","average","adjudicate","link","intimate","finance","research","contend","quicken","purr","purchase","resent","infect","investigate","recite","doubt","deliver","feature","champion","stem","paralyze","disturb","progress","apprehend","surprise","confide","circumvent","synthesize","engage","perish","repeat","sustain","dust","conform","owe","divorce","conflict","cooperate","drop","reveal","store","hunt","craft","back","blame","fossilize","skid","ingrain","heat","embody","track","utilize","treat","convey","wield","share","taint","dye","meet","risk","uproot","practice","unravel","imitate","sack","motivate","force","steal","decide","pop","utter","abuse","slow","advance","love","familiarize","crash","interrelate","approximate","affirm","wear","soar","see","organize","install","instruct","please","gather","withstand","war","shatter","ring","snuggle","pack","mime","renovate","consult","yield","chat","fight","support","interfere","enrich","improve","vow","hire","enhance","innovate","sign","review","overcook","rank","triumph","crowd","systematize","resume","view","enact","man","peel","fill","spy","scold","redesign","conk","consume","wed","declare","initiate","award","load","behold","quantify","rough","matter","refine","experiment","indulge","scorn","consist","stray","inherit","amount","ride","eliminate","maximize","form","conclude","tread","complain","introduce","cling","gauge","pool","convict","couple","multiply","marry","cripple","mow","pander","peruse","account","protect","obscure","undo","sum","permit","hurl","trouble","neglect","erupt","impress","supersede","mount","trust","wad","supply","figure","time","succumb","assume","attempt","look","disclose","vanish","walk","drum","side","seat","vie","speak","summarize","legitimize","absorb","perceive","threaten","endanger","orient","address","telephone","deplete","stall","witness","boost","awaken","stimulate","misrepresent","damp","further","circulate","loom","stunt","destabilize","spur","squander","choose","regret","sound","confirm","entice","arm","utilise","disappear","control","enslave","term","crop","profit","paper","throng","dream","wet","apprise","combine","block","felt","mix","disenfranchise","catch","regain","predict","transfer","phone","appoint","discriminate","compensate","clear","emphasize","surface","succeed","uncover","overthrow","isolate","melt","negotiate","struggle","analyze","ritualize","baffle","vilify","fear","pursue","father","blur","stain","mark","employ","swing","trigger","highlight","publish","discourage","master","surround","populate","join","notice","reflect","advertise","lend","comply","educate","exaggerate","characterize","augment","suffice","deceive","unify","appraise","duplicate","give","route","overshadow","teach","cart","prod","pride","misbehave","embark","implant","devote","deal","reinforce","demarcate","disprove","cover","postpone","verify","originate","wrench","reverse","violate","translate","rebel","bestow","designate","expose","prompt","claim","preserve","update","frame","transform","fire","philosophize","falter","climb","jack","certify","insult","lure","sing","tell","determine","inhibit","buy","save","hook","precede","creep","accede","cement","cook","whip","penalise","wheeze","pace","rent","step","instigate","grasp","monopolize","emulate","require","grade","ignite","reconsider","follow","tilt","knit","expel","bite","bath","induce","aggravate","lessen","admire","dislike","head","announce","contrast","sail","sex","locate","chalk","guarantee","flourish","gear","alien","buck","fancy","overestimate","practise","seek","cope","praise","heighten","hand","ameliorate","promulgate","equip","defend","enliven","clog","poison","exceed","connect","fell","spice","pet","migrate","present","model","line","starve","preoccupy","revolutionize","encourage","marvel","obliterate","desire","subvert","antagonize","bolster","need","correct","apply","speed","resort","tie","transpire","moot","cheat","pronounce","satisfy","jail","deviate","run","arrive","misinform","outrage","salvage","leave","pollute","sight","internalize","pull","bear","prescribe","prognosticate","encumber","behave","adapt","create","qualify","fling","compose","encase","allow","exacerbate","tune","issue","loiter","concentrate","gad","end","foresee","haunt","bed","crinkle","fuss","inhale","star","renew","precipitate","deserve","accept","reheat","refer","fund","obtain","suppose","holiday","scoff","retrofit","voice","happen","hat","misunderstand","scratch","excite","enlighten","chart","occur","staff","service","right","injure","brand","proliferate","constrain","realise","recount","oblige","stretch","market","breed","borrow","facilitate","advocate","sweep","entertain","admit","accuse","plough","regiment","ascribe","tackle","drown","knock","whisper","memorize","torture","forget","price","chase","equal","haul","document","dispirit","reason","trace","engineer","orbit","reign","score","lighten","betray","act","engulf","dig","home","power","worsen","establish","return","surpass","minify","attract","dawdle","energize","lobby","shake","vacation","divide","titillate","roam","predispose","bathe","rewrite","ship","advantage","wind","hang","specify","waste","make","repeal","revile","fulfill","dangle","substitute","exclaim","check","scan","fall","toil","paint","appreciate","sleep","ensure","reconstruct","hypothesize","demote","theorize","plane","concede","roll","profess","revise","whistle","deter","tarnish","beat","discuss","linger","cough","gain","embalm","defy","capture","deify","amend","curb","surf","thrill","label","drag","engender","raise","streak","hide","cry","count","boil","release","suit","baste","replicate","vex","capitalize","intertwine","tighten","thwart","inflict","manifest","extract","litter","propel","want","strew","bore","misinterpret","elevate","joust","light","parade","sport","click","belie","conceal","float","attribute","contradict","adjust","culminate","sharpen","reduce","mention","spend","dub","compel","lament","overeat","scream","commit","punch","email","race","reform","attest","delay","obey","sneak","record","circumnavigate","purify","rip","battle","defrost","mold","kick","shut","unveil","deploy","convince","escalate","accumulate","spawn","scale","rely","plow","repudiate","confer","disseminate","discontinue","nip","rock","roast","title","dive","mine","associate","bet","carry","spring","entail","graduate","vote","empower","coat","mandate","withdraw","amuse","move","oppose","dilute","inspect","develop","warn","scare","glow","win","recover","guide","minimise","combat","endow","credit","prioritise","secure","fascinate","sense","incase","direct","destroy","factor","prevent","major","exclude","speculate","select","gossip","strike","condone","formulate","discredit","dispute","process","patent","cast","answer","partake","condemn","position","cut","soothe","state","smoke","industrialize","fortify","rush","bias","dissent","weed","tear","circle","situate","sponsor","weightlift","dread","know","adopt","interrogate","jump","manage","deem","conceive","filter","skew","favor","overrate","profile","tolerate","conjure","weigh","substantiate","reassure","articulate","cure","focus","even","budget","trim","envy","inculcate","remember","signal","misuse","manipulate","draw","last","incur","hold","mature","handle","resemble","publicize","underpin","stack","push","relegate","seal","interpret","question","short","spill","complicate","wait","pick","distort","challenge","demonstrate","incline","penalize","span","bind","serve","demand","open","lower","suggest","thank","land","belong","discipline","stay","imagine","hit","phrase","redefine","base","search","place","lock","send","prepare","necessitate","range","acquire","kidnap","appear","allot","delete","quit","browse","complete","pressure","use","design","censor","signify","pass","recreate","rat","swell","carve","chew","infringe","authorize","discomfit","saturate","realize","crush","smash","bully","recommend","forge","spark","stifle","rise","object","rout","prevail","import","overstate","up","transfix","grind","rage","regulate","sentence","note","test","pale","suppress","complement","tout","disallow","date","harness","overwhelm","comment","calculate","express","pal","program","disagree","sue","ask","embarrass","rape","vary","indicate","neighbor","activate","restore","forfeit","alleviate","become","fool","apologize","grow","jerk","abdicate","ravage","respond","debate","eradicate","kill","donate","operate","dispose","aid","flood","conquer","hear","order","examine","die","compile","steer","tat","wane","stand","poll","guess","mire","restrain","sanction","computerize","convert","fly","retire","react","sap","own","let","collapse","protest","enter","boom","abhor","lay","intermarry","detect","explain","bound","separate","embrace","lean","file","destruct","raze","mislead","mistake","wire","achieve","approach","nourish","inform","spread","simulate","structure","frustrate","annoy","identify","prosecute","bellow","outsource","promise","represent","swim","parse","evolve","interweave","underestimate","be","opt","pay","pose","retake","imprison","retain","allocate","modify","undertake","remain","register","concur","bewilder","anticipate","distract","describe","safeguard","assimilate","manicure","discard","attend","intensify","deduct","undergo","confine","afflict","wreak","confuse","rid","erase","resist","earn","suffer","comprehend","narrow","perpetuate","explore","ostracize","play","hesitate","coerce","silence","deplore","rival","hate","dial","emerge","like","reshape","depart","fetch","predicate","put","resign","say","classify","enjoy","survey","reward","hop","disobey","suspect","covet","decrease","pioneer","fee","come","reexamine","incorporate","found","correspond","outweigh","discharge","visit","instill","accord","transmit","fare","alter","disparage","inject","render","maintain","jog","pinpoint","consider","upgrade","think","trick","laud","compute","name","smell","care","pit","reap","bridge","justify","cod","ail","age","train","overlook","expend","resolve","drench","restrict","infer","hurt","reach","analyse","elaborate","paste","minimize","start","widen","overburden","vibrate","wake","assign","relay","finish","write","crack","preclude","wish","clean","stabilize","shun","seem","magnify","live","fail","accrue","giggle","reside","debase","automate","shape","keep","prohibit","effect","personalise","impair","upset","damage","meditate","assess","reject","burgeon","replace","distrust","talk","interact","collect","rubbish","welcome","impede","participate","hasten","underlie","value","slice","stress","recruit","beg","drive","skim","hamper","subject","punish","fine","endorse","expand","administer","spell","imply","couch","jar","keen","round","define","cost","emit","commission","advise","launch","converse","reply","ignore","report","inspire","ban","coincide","refuse","defeat","argue","feed","burn","change","ward","point","feel","swarm","learn","slam","supervise","caress","deprive","compare","arise","televise","contain","decipher","encounter","measure","govern","solve","affect","rule","observe","outlaw","wash","solicit","amaze","watch","seep","avoid","type","favour","concern","cultivate","eat","set","pilot","abandon","crank","supplant","dictate","lose","stop","throw","case","comfort","continue","hope","read","tend","skyrocket","involve","accompany","strengthen","find","conduct","confront","lie","infuse","estimate","provide","doom","dance","function","revolve","laugh","diminish","differentiate","forgive","add","surmise","preach","remind","deteriorate","depend","simplify","cite","habituate","influence","corrupt","reserve","purse","ponder","approve","lead","empathise","invite","impact","clarify","cause","compete","jam","receive","digest","purport","request","attain","seize","house","endure","abolish","accustom","convene","labor","criticize","respect","enrol","freeze","remove","dismantle","contaminate","camp","enroll","farm","conserve","list","cherish","subsidize","study","tire","submit","attach","display","murder","stumble","denote","exercise","double","ridicule","net","spiral","distinguish","depict","sit","abide","refrain","code","jeopardize","build","interest","enforce","extend","fashion","lag","recognize","invade","perform","exchange","project","dominate","repair","call","peer","encode","result","show","lease","dwell","disdain","repute","worry","equate","assert","mimic","insist","withhold","listen","exist","plant","intervene","rag","illustrate","communicate","stare","coordinate","help","fuel","patrol","regurgitate","consent","face","quote","subscribe","offend","instal","distribute","recognise","execute","shout","plan","materialize","socialize","overcome","clutter","mean","agree","misspell","sully","aim","integrate","prove","bar","relax","contribute","impose","scribble","discover","charge","differ","possess","lack","offset","forgo","judge","broadcast","plummet","command","acknowledge","begin","rate","produce","chill","incite","settle","frequent","demolish","undermine","alienate","pertain","water","singe","print","temper","fix","deduce","occupy","subside","afford","touch","presuppose","prize","construct","limit","obviate","specialize","sacrifice","adhere","hinder","attack","evoke","field","err","presume","switch","slide","intend","encroach","constitute","cease","drink","despise","enable","assure","taste","forsake","accomplish","correlate","drift","travel","mind","reignite","dress","thrive","photograph", 'fuck', 'smother'];

knwl.english.adjectives = [
	'red',
	'blue',
	'green',
	'orange',
	'black',
	'white',
	'yellow',
	'purple',
	'really',
	'sweet',
	'sour',
	'bitter',
	'evil'
];

knwl.english.pronouns = [
	'i',
	'you',
	'he',
	'she',
	'it',
	'we',
	'they',
];

knwl.english.dOs = [
	'me',
	'you',
	'him',
	'her',
	'them',
	'it',
	'his',
];

knwl.english.nonNouns = [
	'the',
	'that',
	'those',
	'these',
	'this'
];
knwl.english.prepositionalPhrases = [
	["about"], ["below"], ["in", "spite", "of"], ["regarding"], ["above"], ["beneath"], ["instead", "of"], ["since"], 
	["according", "to"], ["beside"], 
	["into"], ["through"], ["across"], ["between"], ["like"], ["throughout"], ["after"], ["beyond"], ["near"], ["to"], ["against"], 
	["but"], ["of"], ["toward"], ["along"], ["by"], ["off"], ["under"], ["amid"], ["concerning"], ["on"], 
	["underneath"], ["among"], ["down"], ["on", "account", "of"], ["until"], ["around"], ["during"], ["onto"], ["up"], ["at"], ["except"], 
	["out"], ["upon"], ["atop"], ["for"], ["out", "of"], ["with"], ["because", "of"], ["from"], ["outside"], ["within"], ["before"], ["in"], 
	["over"], ["without"], ["behind"], ["inside"], ["past"], ["away", "from"]
];

knwl.english.getSentences = function(words) {
	var sentences = [];
	var sentencesObj = []; //will house metadata
	var sentence = [];
	for (var i = 0; i < words.length; i++) {
		sentence.push(words[i].replace(/[?!.]/g, ''));
		if (words[i].search(/[?!.]/g) !== -1) {
			if (words[i -1] !== undefined && words[i -1] !== /[?!.]/g) {
				sentences.push(sentence);
				sentencesObj.push({
					subject: null,
					verb: null,
					verbTense: null,
					dO: null,
				});
				sentence = [];
			}
		}
	}
	return {sentences: sentences, sentencesObj: sentencesObj};
};
knwl.english.findSentences = function() {
	
	var words = knwl.words.linkWordsCasesensitive;
	var s = knwl.english.getSentences(words);
	var sentences = s.sentences;
	var sentencesObj = s.sentencesObj;
	
	for (var ss = 0; ss < sentences.length; ss++) {
		var sentence = sentences[ss];
		
		//find verb
		var verbPos = 0;
		for (var ww = 0; ww < sentence.length; ww++) {
			var found = false;
			for (var vv = 0; vv < knwl.english.verbs.length; vv++) {
				if ((sentence[ww].toLowerCase() === knwl.english.verbs[vv]) || (sentence[ww].toLowerCase() === knwl.english.verbs[vv].substr(0, knwl.english.verbs[vv].length - 1) + 'ing')) {
					sentencesObj[ss].verb = sentence[ww],
					sentencesObj[ss].verbTense =  'present or future';
					found = true;
					verbPos = ww;
				} else if ((sentence[ww].toLowerCase() === knwl.english.verbs[vv] + 'ed') || (sentence[ww].toLowerCase() === knwl.english.verbs[vv] + 'd')) {

					sentencesObj[ss].verb = sentence[ww],
					sentencesObj[ss].verbTense =  'past';
					found = true;
					verbPos = ww;
				} 
			}
			if (found === true) {
				break;
			}
		}

		//find subject (subject)		
		var foundSubject = false;
		for (var ww = 0; ww < verbPos; ww++) {
			for (var nn = 0; nn < knwl.english.pronouns.length; nn++) {
				if (sentence[ww].toLowerCase() === knwl.english.pronouns[nn]) {
					sentencesObj[ss].subject = sentence[ww];
					foundSubject = true;
					break;
				}
			}
			if (foundSubject === true) {
				break;
			}
		}
		if (foundSubject === false) {
			for (var ww = 0; ww < verbPos; ww++) {
				if (sentence[ww].toLowerCase() !== sentence[ww]) {
					var isNotNoun = false;
					for (var un = 0; un < knwl.english.nonNouns.length; un++) {
						if (sentence[ww].toLowerCase() === knwl.english.nonNouns[un]) {
							isNotNoun = true;
						}
					}
					if (isNotNoun === true) {
						sentencesObj[ss].subject = sentence[ww + 1];
						foundSubject = true;
						break;
					} else if (isNotNoun === false) {
						sentencesObj[ss].subject = sentence[ww];
						foundSubject = true;
						break;
					}
				}
				if (foundSubject === true) {
					break;
				}
			}
		}
		if (foundSubject === false) {
			sentencesObj[ss].subject = 'you (implied)';
			foundSubject = true;
		}
		
		//find direct object		
		var foundDO = false;
		for (var ww = verbPos + 1; ww < sentence.length; ww++) {
			for (var dd = 0; dd < knwl.english.dOs.length; dd++) {
				if (sentence[ww].toLowerCase() === knwl.english.dOs[dd]) {
					sentencesObj[ss].dO = sentence[ww];
					foundDO = true;
					break;
				}
			}
			if (foundDO === true) {
				break;
			}
		}
		if (foundDO === false) {
			for (var ww = verbPos + 1; ww < sentence.length; ww++) {
				if (sentence[ww].toLowerCase() !== sentence[ww]) {
					var isNotNoun = false;
					for (var un = 0; un < knwl.english.nonNouns.length; un++) {
						if (sentence[ww].toLowerCase() === knwl.english.nonNouns[un]) {
							isNotNoun = true;
						}
					}
					if (isNotNoun === true) {
						sentencesObj[ss].dO = sentence[ww + 1];
						foundDO = true;
						break;
					} else if (isNotNoun === false) {
						sentencesObj[ss].dO = sentence[ww];
						foundDO = true;
						break;
					}
				}
				if (foundDO === true) {
					break;
				}
			}
		}
		if (foundDO === false) {
			console.log("BOT")
			for (var ww = 0; ww < verbPos; ww++) {
				if (sentence[ww] === 'was') {
					console.log("A!");
					sentencesObj[ss].dO = sentence[ww-1];
					sentencesObj[ss].subject = null;
					for (var ee = verbPos + 1; ee < sentence.length; ee++) {
						if (sentence[ee] === 'by') {
							sentencesObj[ss].subject = sentence[ee+1];
							break;
						}
					}
					break;
				}
			}
		}
	}
	return sentencesObj;
};

knwl.english.findVerbs = function(words) {
	var verbs = [];
	for (var ii = 0; ii < words.length; ii++) {
		for (var ee = 0; ee < knwl.english.verbs.length; ee++) {
			if (words[ii] === knwl.english.verbs[ee]) {
				verbs.push(words[ii]);
			}
		}
	}
	return verbs;
};

knwl.parserList.english = {
	calls: knwl.english.findSentences
};